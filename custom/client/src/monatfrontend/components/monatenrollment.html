<header class="site-header d-flex flex-column">
	<div class="container">
		<div class="header-row">
			<div class="left-nav">
				
			</div>
			<a href="#" class="logo">
				<img src="/themes/monat/assets/images/logo.svg"  alt="Monat logo">
			</a>			
			<div class="right-nav">
				<div class="header-cart">
					<hybrid-cart type="monatEnrollment.type" is-enrollment="true"></hybrid-cart>
				</div>			
			</div>			
		</div>
		
		<div class="notifications">
			<!-- threshold has been met --->
			<div
				ng-hide=
				"monatEnrollment.currentStepName != 'todaysOrder' 
				|| monatEnrollment.monatService.cart.subtotal - monatEnrollment.orderTemplateService.cartTotalThresholdForOFYAndFreeShipping <= 0"
				ng-show=
				"monatEnrollment.currentStepName == 'todaysOrder'
				&& monatEnrollment.type = 'vip'
				&& monatEnrollment.monatService.cart.subtotal - monatEnrollment.orderTemplateService.cartTotalThresholdForOFYAndFreeShipping > 0"
				class="alert-message">
					<span ng-hide="!monatEnrollment.orderTemplateService.cartTotalThresholdForOFYAndFreeShippingLoaded" sw-rbkey="'frontend.enrollment.threshold'"></span>
					<i ng-hide="!monatEnrollment.orderTemplateService.cartTotalThresholdForOFYAndFreeShippingLoaded" class="fal fa-check-circle"></i>
			</div>
		</div>
	</div>
			<!----<toaster-container></toaster-container>---->
	<div 
		ng-if="
			monatEnrollment.currentStepName == 'orderListing' 
			&& +monatEnrollment.orderTemplateService.cartTotalThresholdForOFYAndFreeShipping - monatEnrollment.orderTemplateService.mostRecentOrderTemplate.calculatedSubTotal > 0" 
			class="alert discount-block text-white promotion-bar-block"
	>
		<button 
			id="close-promo" 
			type="button" 
			class="close" 
			data-dismiss="alert"
			aria-label="Close"
		><i class="far fa-times"></i></button>

		<span sw-rbKey="'frontend.flexship.yourFlexshipIs'"></span> 
		{{
			+monatEnrollment.orderTemplateService.cartTotalThresholdForOFYAndFreeShipping - monatEnrollment.orderTemplateService.mostRecentOrderTemplate.calculatedSubTotal 
			| swcurrency: monatEnrollment.orderTemplateService.mostRecentOrderTemplate.currencyCode
		}} 
	
		<span sw-rbKey="'frontend.flexship.beforeYouCanEnroll'"></span>
	</div>
	
	<div 
		ng-if="monatEnrollment.currentStepName == 'todaysOrder' && monatEnrollment.monatService.cart.canPlaceOrderMessage.message.length" 
		class="alert discount-block text-white promotion-bar-block"
	>
		<button 
			id="close-promo" 
			type="button" 
			class="close" 
			data-dismiss="alert"
			aria-label="Close"
		><i class="far fa-times"></i></button>
		{{monatEnrollment.monatService.cart.canPlaceOrderMessage.message}} 
	</div>
	<div 
		ng-if="
			(monatEnrollment.currentStepName == 'orderListing' &&  monatEnrollment.orderTemplateService.mostRecentOrderTemplate.purchasePlusMessage.message.length) 
			|| ( monatEnrollment.currentStepName == 'todaysOrder' && monatEnrollment.monatService.cart.purchasePlusMessage.message.length)" 
		class="alert discount-block text-white promotion-bar-block"
	>
		<button 
			id="close-promo" 
			type="button" 
			class="close" 
			data-dismiss="alert"
			aria-label="Close"
		><i class="far fa-times"></i></button>
		{{
			monatEnrollment.currentStepName == 'orderListing' 
			? monatEnrollment.orderTemplateService.mostRecentOrderTemplate.purchasePlusMessage.message
			:monatEnrollment.monatService.cart.purchasePlusMessage.message
		}}
		
	</div>
	
</header>


<ng-transclude></ng-transclude>

<div ng-cloak ng-show="monatEnrollment.showCanPlaceOrderAlert && !monatEnrollment.monatService.canPlaceOrder" class="alert alert-danger alert-dismissible fade show text-center can-place-order-alert" role="alert">
    <span sw-rbkey="'frontend.order.canPlaceOrderFailure'"></span>
</div>
<footer ng-if="monatEnrollment.currentStepName !== 'checkout'" class="steps-footer d-flex flex-column">
	
	<div class="w-100 d-flex justify-content-between align-items-center">
		<!-- Back button --->
		<div class="d-flex align-items-center">
			<a 
				href 
				data-ng-click="monatEnrollment.previous()" 
				class="back d-inline-block" 
				ng-class="{ 
					invisible: (monatEnrollment.position == 0 ), 
				}"
			>
				<span class="last" sw-rbkey="'frontend.global.back'"></span>
				<i class="fas fa-chevron-left"></i> 
			</a>

			<span ng-if="monatEnrollment.cart.totalItemQuantity > 0 && monatEnrollment.showMiniCart" class="qty-and-price text-white pl-3">
				{{ monatEnrollment.cart.totalItemQuantity }} 
				<span sw-rbkey="'frontend.flexshipCartContainer.items'"></span> / 
				<span sw-rbkey="'frontend.flexshipCartContainer.total'"></span> 
				<span ng-bind-html="monatEnrollment.cart.total | swcurrency:monatEnrollment.cart.currencyCode"></span> 
				<small ng-click="monatEnrollment.toggleMiniCart()" class="border-bottom ml-3">{{monatEnrollment.cartText}}</small>
			</span>
		</div>
		
		<!----VIP step icon indicators --->
		<div ng-if=" monatEnrollment.type=='vip' || monatEnrollment.type=='vipUpgrade'" class="vip-steps step-status row text-center align-items-end">
			<div 
				class="col mt-1"
				ng-style="{ 'opacity' : (monatEnrollment.currentStepName == 'todaysOrder' || monatEnrollment.currentStepName == undefined ) ? '100%' : '50%' }"
			>
				<i 
					class="far"
					ng-class="monatEnrollment.stepClassArray.indexOf(monatEnrollment.currentStepName) > monatEnrollment.stepClassArray.indexOf('todaysOrder') ? 'fa-check' : 'fa-shopping-basket' "
				></i>	
				<p class="mb-1" sw-rbkey="'frontend.cart.todaysOrder'"></p>
			</div>
			
			<div 
				ng-if="monatEnrollment.hasOFYItems"
				class="col mt-1"
				ng-style="{ 'opacity' : (monatEnrollment.currentStepName == 'ofy') ? '100%' : '50%' }"
			>
				 <i 
					class="far" 
					ng-class="monatEnrollment.stepClassArray.indexOf(monatEnrollment.currentStepName) > monatEnrollment.stepClassArray.indexOf('ofy') ? 'fa-check' : 'fa-gift' "
				></i>	
				<p class="mb-1" sw-rbkey="'frontend.flexshipFlow.onlyForYou'"></p>
			</div>
			
			<div 
				class="col mt-1"
				ng-style="{ 'opacity' : (monatEnrollment.currentStepName == 'subscription') ? '100%' : '50%' }"
			>
				<i 
					class="far"
					ng-class="monatEnrollment.stepClassArray.indexOf(monatEnrollment.currentStepName) > monatEnrollment.stepClassArray.indexOf('subscription') ? 'fa-check' : 'fa-calendar-plus' "
				></i>	
				<p class="mb-1" sw-rbkey="'frontend.flexship.frequency'"></p>
			</div>
			
			<div 
				class="col"
				ng-style="{ 
					'opacity' : (monatEnrollment.currentStepName == 'shopIntro' || monatEnrollment.currentStepName == 'orderListing'  ) ? '100%' : '50%' 
				}"
			>
				<i 
					class="far"
					ng-class="monatEnrollment.stepClassArray.indexOf(monatEnrollment.currentStepName) > monatEnrollment.stepClassArray.indexOf('orderListing') ? 'fa-check' : 'fa-shipping-timed' "
				></i>
				<p class="mb-1" sw-rbkey="'entity.OrderTemplate'"></p>
			</div>
			
			<div 
				ng-if="!monatEnrollment.upgradeFlow"
				class="col"
				ng-style="{ 'opacity' : (monatEnrollment.currentStepName == 'createAccount' ) ? '100%' : '50%' }"
			>
				<i 
					class="far" 
					ng-class="monatEnrollment.stepClassArray.indexOf(monatEnrollment.currentStepName) > monatEnrollment.stepClassArray.indexOf('createAccount') ? 'fa-check' : 'fa-user-plus' "
				></i>
				<p class="mb-1" sw-rbkey="'frontend.createAccount.createAccountBtn'"></p>
			</div>
			
			<div class="col">
				<i class="far fa-credit-card"></i>
				<p class="mb-1" sw-rbkey="'frontend.global.checkout'"></p>
			</div>
			
			<div ng-if="monatEnrollment.account.accountStatusType.systemCode != 'astGoodStanding'" class="col">
				<i class="far fa-user-friends"></i>
				<p class="mb-1" sw-rbkey="'frontend.global.sponsor'"></p>
			</div>
			
		</div>

		<!----MP Step icon indicators --->
		<div ng-if="monatEnrollment.type=='mp' || monatEnrollment.type=='mpUpgrade'" class="mp-steps step-status row text-center align-items-end">
			<div 
				class="col mt-1"
				ng-style="{ 'opacity' : (monatEnrollment.currentStepName == 'starterPack' || monatEnrollment.currentStepName == undefined ) ? '100%' : '50%' }"
			>
				<i 
					class="far" 
					ng-class="monatEnrollment.stepClassArray.indexOf(monatEnrollment.currentStepName) > monatEnrollment.stepClassArray.indexOf('starterPack') ? 'fa-check' : 'fa-wine-bottle' "
				></i>	
				<p class="mb-1" sw-rbkey="'frontend.global.productPack'"></p>
			</div>
			
			<div 
				class="col"
				ng-style="{ 
					'opacity' : (monatEnrollment.currentStepName == 'todaysOrder' ) ? '100%' : '50%' 
				}"
			>
				<i 
					class="far"
					ng-class="monatEnrollment.stepClassArray.indexOf(monatEnrollment.currentStepName) > monatEnrollment.stepClassArray.indexOf('todaysOrder') ? 'fa-check' : 'fa-shopping-basket' "  
				></i>
				<p class="mb-1" sw-rbkey="'frontend.cart.todaysOrder'"></p>
			</div>
			
			<div 
				ng-if="!monatEnrollment.upgradeFlow"
				class="col"
				ng-style="{ 'opacity' : (monatEnrollment.currentStepName == 'createAccount' || monatEnrollment.currentStepName=='updateAccount') ? '100%' : '50%' }"
			>
				<i 
					class="far"
					ng-class="
						( 
							monatEnrollment.stepClassArray.indexOf(monatEnrollment.currentStepName) > monatEnrollment.stepClassArray.indexOf('createAccount') 
							&&  monatEnrollment.stepClassArray.indexOf(monatEnrollment.currentStepName) > monatEnrollment.stepClassArray.indexOf('updateAccount') 
						) 
						? 'fa-check' : 'fa-user-plus' "  
				></i>
				<p class="mb-1" sw-rbkey="'frontend.createAccount.createAccountBtn'"></p>
			</div>
			
			<div 
				ng-if="monatEnrollment.upgradeFlow"
				class="col"
				ng-style="{ 'opacity' : (monatEnrollment.currentStepName == 'createAccount' || monatEnrollment.currentStepName=='updateAccount') ? '100%' : '50%' }"
			>
				<i 
					class="far"
					ng-class="monatEnrollment.stepClassArray.indexOf(monatEnrollment.currentStepName) > monatEnrollment.stepClassArray.indexOf('updateAccount') ? 'fa-check' : 'fa-briefcase'"
				></i>
				<p class="mb-1" sw-rbkey="'frontend.enrollment.businessDetails'"></p>
			</div>
			
			<div class="col">
				<i class="far fa-credit-card"></i>
				<p class="mb-1" sw-rbkey="'frontend.global.checkout'"></p>
			</div>
			
			<div ng-if="monatEnrollment.account.accountStatusType.systemCode != 'astGoodStanding'" class="col">
				<i class="far fa-user-friends"></i> 
				<p class="mb-1" sw-rbkey="'frontend.global.sponsor'"></p>
			</div>
		</div>
		
		<!-----NEXT BUTTONS ---->
		<div ng-if="
			(monatEnrollment.monatService.canPlaceOrder && !monatEnrollment.flexshipShouldBeChecked) 
			|| (monatEnrollment.monatService.canPlaceOrder && monatEnrollment.orderTemplateService.mostRecentOrderTemplate.canPlaceOrderFlag)
		">
			<button 
				style="z-index: 1" 
				data-ng-click="monatEnrollment.next(); monatEnrollment.showCanPlaceOrderAlert = false" 
				class="btn btn-secondary forward-btn forward" 
				ng-if="monatEnrollment.position + 1 != monatEnrollment.steps.length && monatEnrollment.reviewContext == false"
			>
				<div class="btn-text">
					<span sw-rbkey="'frontend.global.next'"></span>
					<i class="fas fa-chevron-right"></i>
				</div>
			</button>
			<button 
				style="z-index: 1" 
				data-ng-click="monatEnrollment.goToLastStep(); monatEnrollment.showCanPlaceOrderAlert = false" 
				class="btn btn-secondary forward-btn forward" 
				ng-if="monatEnrollment.position + 1 != monatEnrollment.steps.length && monatEnrollment.reviewContext"
			>
				<div class="btn-text">
					<span sw-rbkey="'frontend.global.next'"></span>
					<i class="fas fa-chevron-right"></i>
				</div>
			</button>			
		</div>
		
		<div ng-if="
				(!monatEnrollment.monatService.canPlaceOrder && !monatEnrollment.flexshipShouldBeChecked) 
			|| (!monatEnrollment.monatService.canPlaceCartOrder && !monatEnrollment.orderTemplateService.mostRecentOrderTemplate.canPlaceOrderFlag && monatEnrollment.flexshipShouldBeChecked)
		">
			<button 
				style="z-index: 1" 
				data-ng-click="monatEnrollment.showCanPlaceOrderAlert = true; monatEnrollment.warn('frontend.order.canPlaceOrderFailure')" 
				class="btn btn-secondary forward-btn forward disabled" 
				ng-if="monatEnrollment.position + 1 != monatEnrollment.steps.length && monatEnrollment.reviewContext == false"
			>
				<div class="btn-text">
					<span sw-rbkey="'frontend.global.next'"></span>
					<i class="fas fa-chevron-right"></i>
				</div>
			</button>
		</div>

		<span ng-if="monatEnrollment.position + 1 == monatEnrollment.steps.length"></span>
	</div>

</footer>

