{"version":3,"sources":["controllers/create-bundle-controller.ts"],"names":["getParameterByName"],"mappings":"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","file":"controllers/create-bundle-controller.js","sourceRoot":"/Users/ryanmarchand/Sites/Slatwall/","sourcesContent":["'use strict';\nangular.module('slatwalladmin').controller('create-bundle-controller', [\n\t'$scope',\n\t'$location',\n\t'$log',\n\t'$rootScope',\n\t'$window',\n\t'$slatwall',\n\t'dialogService',\n\t'alertService',\n\t'productBundleService',\n\t'formService',\n\t'partialsPath',\n\tfunction(\n\t\t$scope,\n\t\t$location,\n\t\t$log,\n\t\t$rootScope,\n\t\t$window,\n\t\t$slatwall,\n\t\tdialogService,\n\t\talertService,\n\t\tproductBundleService,\n\t\tformService,\n\t\tpartialsPath\n\t){\n\t\t$scope.partialsPath = partialsPath;\n\t\t\n\t\tfunction getParameterByName(name) {\n\t\t    name = name.replace(/[\\[]/, \"\\\\[\").replace(/[\\]]/, \"\\\\]\");\n\t\t    var regex = new RegExp(\"[\\\\?&]\" + name + \"=([^&#]*)\"),\n\t\t        results = regex.exec(location.search);\n\t\t    return results === null ? \"\" : decodeURIComponent(results[1].replace(/\\+/g, \" \"));\n\t\t}\n\t\t\n\t\t$scope.$id=\"create-bundle-controller\";\n\t\t//if this view is part of the dialog section, call the inherited function\n\t\tif(angular.isDefined($scope.scrollToTopOfDialog)){\n\t\t\t$scope.scrollToTopOfDialog();\n\t\t\t\n\t\t}\n\t\t\n\t\tvar productID = getParameterByName('productID');\n\t\t\n\t\tvar productBundleConstructor = function(){\n\t\t\t$scope.product = $slatwall.newProduct();\n\t\t\tvar brand = $slatwall.newBrand();\n\t\t\tvar productType = $slatwall.newProductType();\n\t\t\t$scope.product.$$setBrand(brand);\n\t\t\t$scope.product.$$setProductType(productType);\n\t\t\t$scope.product.$$addSku();\n\t\t\t$scope.product.data.skus[0].data.productBundleGroups = [];\n\t\t};\n\t\t\n\t\t$scope.productBundleGroup;\n\t\t\n\t\tif(angular.isDefined(productID) && productID !== ''){\n\t\t\tvar productPromise = $slatwall.getProduct({id:productID});\n\t\t\t\n\t\t\tproductPromise.promise.then(function(){\n\t\t\t\t$log.debug(productPromise.value);\n\t\t\t\tproductPromise.value.$$getSkus().then(function(){\n\t\t\t\t\tproductPromise.value.data.skus[0].$$getProductBundleGroups().then(function(){\n\t\t\t\t\t\t\n\t\t\t\t\t\t$scope.product = productPromise.value;\n\t\t\t\t\t\tangular.forEach($scope.product.data.skus[0].data.productBundleGroups,function(productBundleGroup){\n\t\t\t\t\t\t\tproductBundleGroup.$$getProductBundleGroupType();\n\t\t\t\t\t\t\tproductBundleService.decorateProductBundleGroup(productBundleGroup);\n\t\t\t\t\t\t\tproductBundleGroup.data.$$editing = false;\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}, productBundleConstructor());\n\n\t\t} else {\n\t\t\tproductBundleConstructor();\n\t\t}\n\n\t\t$scope.saveProductBundle = function(closeDialogIndex){\n\t\t\t$scope.newSaving = true;\n\t\t\t$log.debug($scope.newSaving);\n            $scope.dIndex = closeDialogIndex;\n\t\t\t$scope.product.$$save().then(function(){\n\t\t\t\t$log.debug(\"Turn off the loader after saving.\");\n\t\t\t\t$scope.newSaving = false;\n                 if(angular.isDefined($scope.dIndex)){\n                    $scope.closeSaving = true;\n                    $rootScope.closePageDialog($scope.dIndex);\n                 }  \n\t\t\t});\n             \n\t\t\t\n\t\t\n\t\t\t\n\t\t};\n\t\t\n\t}\n]);\n"]}