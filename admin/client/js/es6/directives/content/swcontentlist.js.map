{"version":3,"sources":["directives/content/swcontentlist.ts"],"names":["handler"],"mappings":"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","file":"directives/content/swcontentlist.js","sourcesContent":["'use strict';\n\nangular.module('slatwalladmin')\n.directive('swContentList', [\n\t'$log',\n    '$timeout',\n\t'$slatwall',\n\t'partialsPath',\n    'paginationService',\n    'observerService',\n\tfunction (\n\t\t\t$log,\n            $timeout,\n\t\t\t$slatwall,\n\t\t\tpartialsPath,\n            paginationService,\n            observerService\n\t) {\n\t    return {\n\t        restrict: 'E',\n\t        templateUrl:partialsPath+'content/contentlist.html',\n\t        link: function (scope, element, attr) {\n\t        \t$log.debug('slatwallcontentList init');\n\t        \tvar pageShow = 50;\n                if(scope.pageShow !== 'Auto'){\n                    pageShow = scope.pageShow;\n                }\n                \n                scope.loadingCollection = false;\n                \n                scope.selectedSite;\n                scope.orderBy;\n                var orderByConfig;\n                \n\t        \tscope.getCollection = function(isSearching){\n                    var columnsConfig = [\n                        {\n                            propertyIdentifier:'_content.contentID',\n                            isVisible:false,\n                            ormtype:'id',\n                            isSearchable:true\n                        },\n                         {\n                            propertyIdentifier:'_content.site.siteID',\n                            isVisible:false,\n                            ormtype:'id',\n                            isSearchable:false\n                        },\n//                        {\n//                            propertyIdentifier:'_content.site.siteName',\n//                            isVisible:true,\n//                            ormtype:'string',\n//                            isSearchable:true\n//                        },\n                        {\n                            propertyIdentifier:'_content.contentTemplateFile',\n                            persistent:false,\n                            setting:true,\n                            isVisible:true,\n                            isSearchable:false\n                        },\n                        //need to get template via settings\n                        {\n                            propertyIdentifier:'_content.allowPurchaseFlag',\n                            isVisible:true,\n                            ormtype:'boolean',\n                            isSearchable:false\n                        },\n                        {\n                            propertyIdentifier:'_content.productListingPageFlag',\n                            isVisible:true,\n                            ormtype:'boolean',\n                            isSearchable:false\n                        },\n                        {\n                            propertyIdentifier:'_content.activeFlag',\n                            isVisible:true,\n                            ormtype:'boolean',\n                            isSearchable:false\n                        }\n                    ];\n                    \n\t        \t\tvar options = {\n                        currentPage:scope.currentPage, \n                        pageShow:paginationService.getPageShow(), \n                        keywords:scope.keywords\n                    };\n                    var column = {};\n                    if(!isSearching || scope.keywords === ''){\n                         var filterGroupsConfig =[\n                            {\n                              \"filterGroup\": [\n                                {\n                                  \"propertyIdentifier\": \"_content.parentContent\",\n                                  \"comparisonOperator\": \"is\",\n                                  \"value\": 'null'\n                                }\n                              ]\n                            }\n                          ];\n                         column = {\n                            propertyIdentifier:'_content.title',\n                            isVisible:true,\n                            ormtype:'string',\n                            isSearchable:true\n                        };\n                        columnsConfig.unshift(column);\n                    }else{\n                        var filterGroupsConfig =[\n                            {\n                              \"filterGroup\": [\n                                {\n                                  \"propertyIdentifier\": \"_content.excludeFromSearch\",\n                                  \"comparisonOperator\": \"=\",\n                                  \"value\": false\n                                },\n                                { \n                                  \"logicalOperator\":\"OR\",\n                                  \"propertyIdentifier\": \"_content.excludeFromSearch\",\n                                  \"comparisonOperator\": \"is\",\n                                  \"value\": \"null\"\n                                }\n                              ]\n                            }\n                          ];\n                       column = {\n                            propertyIdentifier:'_content.title',\n                            isVisible:false,\n                            ormtype:'string',\n                            isSearchable:true\n                        };\n                        columnsConfig.unshift(column);\n\n                        var titlePathColumn = {\n                            propertyIdentifier:'_content.titlePath',\n                            isVisible:true,\n                            ormtype:'string',\n                            isSearchable:false\n                        };  \n                        columnsConfig.unshift(titlePathColumn);\n                    }\n                    //if we have a selected Site add the filter\n                    if(angular.isDefined(scope.selectedSite)){\n                        var selectedSiteFilter = {\n                            logicalOperator:\"AND\",\n                            propertyIdentifier:\"_content.site.siteID\",\n                            comparisonOperator:\"=\",\n                            value:scope.selectedSite.siteID\n                        };\n                        filterGroupsConfig[0].filterGroup.push(selectedSiteFilter);\n                    }\n                    \n                    if(angular.isDefined(scope.orderBy)){\n                        var orderByConfig = [];\n                        orderByConfig.push(scope.orderBy);    \n                        options.orderByConfig = angular.toJson(orderByConfig);\n                    }\n                    \n                    \n                    options.filterGroupsConfig = angular.toJson(filterGroupsConfig);\n                    options.columnsConfig = angular.toJson(columnsConfig);\n                    \n\t        \t\tvar collectionListingPromise = $slatwall.getEntity(\n                        scope.entityName, \n                        options\n                    );\n\t        \t\tcollectionListingPromise.then(function(value){\n\t        \t\t\tscope.collection = value;\n\t        \t\t\tscope.collectionConfig = angular.fromJson(scope.collection.collectionConfig);\n\t        \t\t\tscope.collectionConfig.columns = columnsConfig;\n\t        \t\t\tscope.collection.collectionConfig = scope.collectionConfig;\n                        scope.loadingCollection = false;\n\t        \t\t});\n\t        \t};\n\t        \tscope.getCollection(false);\n                \n                scope.keywords = \"\";\n                scope.loadingCollection = false;\n                var searchPromise;\n                scope.searchCollection = function(){\n                    \n                    if(searchPromise) {\n                        $timeout.cancel(searchPromise);\n                    }\n                    \n                    searchPromise = $timeout(function(){\n                        $log.debug('search with keywords');\n                        $log.debug(scope.keywords);\n                        $('.childNode').remove();\n                        //Set current page here so that the pagination does not break when getting collection\n                        paginationService.setCurrentPage(1);\n                        scope.loadingCollection = true;\n                        scope.getCollection(true);\n                    }, 500);\n                };\n               \n                \n            var siteChanged = function(selectedSiteOption){\n                scope.selectedSite = selectedSiteOption;\n                scope.getCollection();\n            }\n            \n            observerService.attach(siteChanged,'optionsChanged','siteOptions');\n                \n            var sortChanged = function(orderBy){\n                scope.orderBy = orderBy;\n                scope.getCollection();\n            };\n            observerService.attach(sortChanged,'sortByColumn','siteSorting');\n            \n            scope.$on('$destroy', function handler() {\n                observerService.detachByEvent('optionsChanged');\n                observerService.detachByEvent('sortByColumn');\n            });\n                \n            \n            \n\t    }\n\t}\n}]);"],"sourceRoot":"/source/"}