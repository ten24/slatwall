{"version":3,"sources":["directives/common/form/swformfieldsearchselect.ts"],"names":[],"mappings":"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","file":"directives/common/form/swformfieldsearchselect.js","sourceRoot":"/Users/david/Sites/Slatwall/","sourcesContent":["angular.module('slatwalladmin')\n.directive('swFormFieldSearchSelect', [\n'$http',\n'$log',\n'$slatwall',\n'formService',\n'partialsPath',\n\tfunction(\n\t$http,\n\t$log,\n\t$slatwall,\n\tformService,\n\tpartialsPath\n\t){\n\t\treturn{\n\t\t\ttemplateUrl:partialsPath+'formfields/search-select.html',\n\t\t\trequire:\"^form\",\n\t\t\trestrict: 'E',\n\t\t\tscope:{\n\t\t\t\tpropertyDisplay:\"=\"\n\t\t\t},\n\t\t\tlink:function(scope,element,attr,formController){\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t//set up selectionOptions\n\t\t\t\tscope.selectionOptions = {\n\t\t\t\t\tvalue:[],\n\t\t\t\t\t$$adding:false\n\t\t\t\t};\n\t\t\t\t//match in matches track by\n\t\t\t\t//function to set state of adding new item \n\t\t\t\tscope.setAdding = function(isAdding){\n\t\t\t\t\tscope.isAdding = isAdding;\n\t\t\t\t\tscope.showAddBtn = false;\n\t\t\t\t};\n\t\t\t\t\n\t\t\t\tscope.selectedOption = {};\n\t\t\t\tscope.showAddBtn = false;\n\t\t\t\tvar propertyMetaData = scope.propertyDisplay.object.$$getMetaData(scope.propertyDisplay.property);\n\t\t\t\t//create basic \n\t\t\t\tvar object = $slatwall.newEntity(propertyMetaData.cfc);\n\t\t\t\t\n//\t\t\t\tscope.propertyDisplay.template = '';\n//\t\t\t\t//check for a template\n//\t\t\t\t//rules are tiered: check if an override is specified at scope.template, check if the cfc name .html exists, use\n//\t\t\t\tvar templatePath = partialsPath + 'formfields/searchselecttemplates/';\n//\t\t\t\tif(angular.isUndefined(scope.propertyDisplay.template)){\n//\t\t\t\t\tvar templatePromise = $http.get(templatePath+propertyMetaData.cfcProperCase+'.html',function(){\n//\t\t\t\t\t\t$log.debug('template');\n//\t\t\t\t\t\tscope.propertyDisplay.template = templatePath+propertyMetaData.cfcProperCase+'.html';\n//\t\t\t\t\t},function(){\n//\t\t\t\t\t\tscope.propertyDisplay.template = templatePath+'index.html';\n//\t\t\t\t\t\t$log.debug('template');\n//\t\t\t\t\t\t$log.debug(scope.propertyDisplay.template);\n//\t\t\t\t\t});\n//\t\t\t\t}\n\t\t\t\t\n\t\t\t\t//set up query function for finding related object\n\t\t\t\tscope.cfcProperCase = propertyMetaData.cfcProperCase;\n\t\t\t\tscope.selectionOptions.getOptionsByKeyword=function(keyword){\n\t\t\t\t\tvar filterGroupsConfig = '['+  \n\t\t\t\t\t  ' {  '+\n\t\t\t\t\t      '\"filterGroup\":[  '+\n\t\t\t\t\t         '{'+\n\t\t\t\t\t        \t' \"propertyIdentifier\":\"_'+scope.cfcProperCase.toLowerCase()+'.'+scope.cfcProperCase+'Name\",'+\n\t\t\t\t\t        \t' \"comparisonOperator\":\"like\",'+\n\t\t\t\t\t        \t ' \"ormtype\":\"string\",'+\n\t\t\t\t\t        \t' \"value\":\"%'+keyword+'%\"'+\n\t\t\t\t\t       '  }'+\n\t\t\t\t\t     ' ]'+\n\t\t\t\t\t  ' }'+\n\t\t\t\t\t']';\n\t\t\t\t\treturn $slatwall.getEntity(propertyMetaData.cfc, {filterGroupsConfig:filterGroupsConfig.trim()})\n\t\t\t\t\t.then(function(value){\n\t\t\t\t\t\t$log.debug('typesByKeyword');\n\t\t\t\t\t\t$log.debug(value);\n\t\t\t\t\t\tscope.selectionOptions.value = value.pageRecords;\n\t\t\t\t\t\t\n\t\t\t\t\t\tvar myLength = keyword.length;\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (myLength > 0) {\n\t\t\t\t\t\t\tscope.showAddBtn = true;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tscope.showAddBtn = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn scope.selectionOptions.value;\n\t\t\t\t\t});\n\t\t\t\t};\n\t\t\t\tvar propertyPromise = scope.propertyDisplay.object['$$get'+propertyMetaData.nameCapitalCase]();\n\t\t\t\tpropertyPromise.then(function(data){\n\t\t\t\t\t\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\t//set up behavior when selecting an item\n\t\t\t\tscope.selectItem = function ($item, $model, $label) {\n\t\t\t\t    scope.$item = $item;\n\t\t\t\t    scope.$model = $model;\n\t\t\t\t    scope.$label = $label;\n\t\t\t\t    scope.showAddBtn = false; //turns off the add btn on select\n\t\t\t\t    //angular.extend(inflatedObject.data,$item);\n\t\t\t\t    object.$$init($item);\n\t\t\t\t    $log.debug('select item');\n\t\t\t\t    $log.debug(object);\n\t\t\t\t    scope.propertyDisplay.object['$$set'+propertyMetaData.nameCapitalCase](object);\n\t\t\t\t};\n\t\t\t\t\n//\t\t\t\tif(angular.isUndefined(scope.propertyDipslay.object[scope.propertyDisplay.property])){\n//\t\t\t\t\t$log.debug('getmeta');\n//\t\t\t\t\t$log.debug(scope.propertyDisplay.object.metaData[scope.propertyDisplay.property]);\n//\t\t\t\t\t\n//\t\t\t\t\t//scope.propertyDipslay.object['$$get'+]\n//\t\t\t\t}\n//\t\t\t\t\n//\t\t\t\tscope.propertyDisplay.object.data[scope.propertyDisplay.property].$dirty = true;\n\t        }\n\t\t};\n\t}\n]);\n\t\n"]}