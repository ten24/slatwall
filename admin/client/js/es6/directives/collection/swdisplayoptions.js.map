{"version":3,"sources":["directives/collection/swdisplayoptions.ts"],"names":[],"mappings":"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","file":"directives/collection/swdisplayoptions.js","sourceRoot":"/Users/david/Sites/Slatwall/","sourcesContent":["angular.module('slatwalladmin')\n.directive('swDisplayOptions',[\n\t'$http',\n\t'$compile',\n\t'$templateCache',\n\t'$log',\n\t'$slatwall',\n\t'collectionService',\n\t'collectionPartialsPath',\n\tfunction(\n\t\t$http,\n\t\t$compile,\n\t\t$templateCache,\n\t\t$log,\n\t\t$slatwall,\n\t\tcollectionService,\n\t\tcollectionPartialsPath\n\t){\n\t\treturn {\n\t\t\trestrict: 'E',\n\t\t\ttransclude:true,\n\t\t\tscope:{\n\t\t\t\torderBy:\"=\",\n\t\t\t\tcolumns:'=',\n\t\t\t\tpropertiesList:\"=\",\n\t\t\t\tsaveCollection:\"&\",\n\t\t\t\tbaseEntityAlias:\"=\",\n\t\t\t\tbaseEntityName:\"=\"\n\t\t\t},\n\t\t\ttemplateUrl:collectionPartialsPath+\"displayoptions.html\",\n\t\t\tcontroller: ['$scope','$element','$attrs',function($scope,$element,$attrs){\n\t\t\t\t$log.debug('display options initialize');\n\t\t\t\t\n\t\t\t\tthis.removeColumn = function(columnIndex){\n\t\t\t\t\t$log.debug('parent remove column');\n\t\t\t\t\t$log.debug($scope.columns);\n\t\t\t\t\tif($scope.columns.length){\n\t\t\t\t\t\t$scope.columns.splice(columnIndex, 1);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t};\n\t\t\t\t\n\t\t\t\tthis.getPropertiesList = function(){\n\t\t\t\t\treturn $scope.propertiesList;\n\t\t\t\t};\n\t\t\t\t\n\t\t\t\t$scope.addDisplayDialog = {\n\t\t\t\t\tisOpen:false,\n\t\t\t\t\ttoggleDisplayDialog:function(){\n\t\t\t\t\t\t$scope.addDisplayDialog.isOpen = !$scope.addDisplayDialog.isOpen; \n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tvar getTitleFromPropertyIdentifier = function(propertyIdentifier){\n\t\t\t\t\tvar baseEntityCfcName = $scope.baseEntityName.replace('Slatwall','').charAt(0).toLowerCase()+$scope.baseEntityName.replace('Slatwall','').slice(1); \n\t\t\t\t\t\n\t\t\t\t\tvar title = '';\n\t\t\t\t\tvar propertyIdentifierArray = propertyIdentifier.split('.');\n\t\t\t\t\tvar currentEntity;\n\t\t\t\t\tvar currentEntityInstance;\n\t\t\t\t\tvar prefix = 'entity.';\n\t\t\t\t\tangular.forEach(propertyIdentifierArray,function(propertyIdentifierItem,key){\n\t\t\t\t\t\t//pass over the initial item\n\t\t\t\t\t\tif(key !== 0 ){\n\t\t\t\t\t\t\tif(key === 1){\n\t\t\t\t\t\t\t\tcurrentEntityInstance = $slatwall['new'+$scope.baseEntityName.replace('Slatwall','')]();\n\t\t\t\t\t\t\t\tcurrentEntity = currentEntityInstance.metaData[propertyIdentifierArray[key]];\n\t\t\t\t\t\t\t\ttitle += $slatwall.getRBKey(prefix+baseEntityCfcName+'.'+propertyIdentifierItem);\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tvar currentEntityInstance = $slatwall['new'+currentEntity.cfc.charAt(0).toUpperCase()+currentEntity.cfc.slice(1)]();\n\t\t\t\t\t\t\t\tcurrentEntity = currentEntityInstance.metaData[propertyIdentifierArray[key]];\n\t\t\t\t\t\t\t\ttitle += $slatwall.getRBKey(prefix+currentEntityInstance.metaData.className+'.'+currentEntity.name);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(key < propertyIdentifierArray.length-1){\n\t\t\t\t\t\t\t\ttitle += ' | ';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\treturn title;\n\t\t\t\t};\n\t\t\t\t\n\t\t\t\t$scope.addColumn = function(selectedProperty, closeDialog){\n\t\t\t\t\t$log.debug('add Column');\n\t\t\t\t\t$log.debug(selectedProperty);\n\t\t\t\t\tif(selectedProperty.$$group === 'simple' || 'attribute'){\n\t\t\t\t\t\t$log.debug($scope.columns);\n\t\t\t\t\t\tif(angular.isDefined(selectedProperty)){\n\t\t\t\t\t\t\tvar column = {};\n\t\t\t\t\t\t\tcolumn.title = getTitleFromPropertyIdentifier(selectedProperty.propertyIdentifier);\n\t\t\t\t\t\t\tcolumn.propertyIdentifier = selectedProperty.propertyIdentifier;\n\t\t\t\t\t\t\tcolumn.isVisible = true;\n\t\t\t\t\t\t\tcolumn.isDeletable = true;\n\t\t\t\t\t\t\t//only add attributeid if the selectedProperty is attributeid\n\t\t\t\t\t\t\tif(angular.isDefined(selectedProperty.attributeID)){\n\t\t\t\t\t\t\t\tcolumn.attributeID = selectedProperty.attributeID;\n\t\t\t\t\t\t\t\tcolumn.attributeSetObject = selectedProperty.attributeSetObject;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t$scope.columns.push(column);\n\t\t\t\t\t\t\t$scope.saveCollection();\n\t\t\t\t\t\t\tif(angular.isDefined(closeDialog) && closeDialog === true){\n\t\t\t\t\t\t\t\t$scope.addDisplayDialog.toggleDisplayDialog();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\t\n\t\t\t\t$scope.selectBreadCrumb = function(breadCrumbIndex){\n\t\t\t\t\t//splice out array items above index\n\t\t\t\t\tvar removeCount = $scope.breadCrumbs.length - 1 - breadCrumbIndex;\n\t\t\t\t\t$scope.breadCrumbs.splice(breadCrumbIndex + 1,removeCount);\n\t\t\t\t\t$scope.selectedPropertyChanged(null);\n\t\t\t\t\t\n\t\t\t\t};\n\t\n\t\t\t\tvar unbindBaseEntityAlias = $scope.$watch('baseEntityAlias',function(newValue,oldValue){\n\t\t\t\t\tif(newValue !== oldValue){\n\t\t\t\t\t\t$scope.breadCrumbs = [ {\n\t\t\t\t\t\t\tentityAlias : $scope.baseEntityAlias,\n\t\t\t\t\t\t\tcfc : $scope.baseEntityAlias,\n\t\t\t\t\t\t\tpropertyIdentifier : $scope.baseEntityAlias\n\t\t\t\t\t\t} ];\n\t\t\t\t\t\tunbindBaseEntityAlias();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\t$scope.selectedPropertyChanged = function(selectedProperty){\n\t\t\t\t\t// drill down or select field?\n\t\t\t\t\t$log.debug('selectedPropertyChanged');\n\t\t\t\t\t$log.debug(selectedProperty);\n\t\t\t\t\t$scope.selectedProperty = selectedProperty;\n\t\t\t\t};\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tjQuery(function($) {\n\t\t\t\t\t\n\t\t\t\t      var panelList = angular.element($element).children('ul');\n\t\t\t\t      panelList.sortable({\n\t\t\t\t          // Only make the .panel-heading child elements support dragging.\n\t\t\t\t          // Omit this to make then entire <li>...</li> draggable.\n\t\t\t\t          handle: '.s-pannel-name',\n\t\t\t\t          update: function(event,ui) {\n\t\t\t\t        \t  var tempColumnsArray = [];\n\t\t\t\t              $('.s-pannel-name', panelList).each(function(index, elem) {\n\t\t\t\t            \t  var newIndex = $(elem).attr('j-column-index');\n\t\t\t\t            \t  var columnItem = $scope.columns[newIndex];\n\t\t\t\t            \t  tempColumnsArray.push(columnItem);\n\t\t\t\t              });\n\t\t\t\t              $scope.$apply(function () {\n\t\t\t\t            \t  $scope.columns = tempColumnsArray;\n\t\t\t\t              });\n\t\t\t\t              $scope.saveCollection();\n\t\t\t\t          }\n\t\t\t\t      });\n\t\t\t\t  });\n\t\t\t\t\n\t\t\t\t/*var unbindBaseEntityAlaisWatchListener = scope.$watch('baseEntityAlias',function(){\n\t\t       \t\t $(\"select\").selectBoxIt();\n\t\t       \t\t unbindBaseEntityAlaisWatchListener();\n\t\t       \t});*/\n\t\t\t}]\n\t\t};\n\t}\n]);\n\n\n\t\n\t\n"]}